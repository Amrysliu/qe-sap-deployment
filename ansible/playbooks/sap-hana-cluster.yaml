---
- hosts: hana
  remote_user: cloudadmin
  become: true
  become_user: root
  vars:
    provider: azure # only provider for now
    use_sbd: yes
    #Azure fencing specific vars
    subscription_id: 
    resource_group:
    tenant_id:
    application_id:
    app_password:
  
  handlers:
  - name: Restart systemd daemon
    ansible.builtin.systemd:
      daemon_reload: yes

  tasks:

  - name: Base Cluster [azure]
    ansible.builtin.include_tasks: ./tasks/azure-cluster-bootstrap.yaml
    when: provider == "azure"
    tags: bootstrap

  - name: Add HANA to cluster [azure]
    ansible.builtin.include_tasks: ./tasks/azure-cluster-hana.yaml
    when:
      - provider == "azure"
      - ansible_hostname == 'vmhana01'
    tags: hana_cluster

 
